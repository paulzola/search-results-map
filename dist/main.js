!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=16)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={lat:56.00484,lng:92.844357};t.default=function(e){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e({lat:t.coords.latitude,lng:t.coords.longitude})}):e(r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){for(var n=e;n&&n.parentNode;){var r=t(n);if(r)return{node:n,result:r};n=n.parentNode}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){return'\n    <div class="srm-empty-history">\n    Ничего не добавлено в историю\n    </div>\n    '}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.name,n=e.location;return'\n    <div class="srm-history-card">\n        <div class="srm-history-card__name">'+t+'</div>\n        <div class="srm-history-card__location">'+n.lat+" "+n.lng+"</div>\n    </div>\n    "}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=u(n(3)),a=u(n(2)),o=u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){var n=this,r=t.container,i=t.onCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._handleBoxClick=function(e){var t=(0,o.default)(e.target,n._cardNodeCheck);t&&"string"==typeof t.result&&n.onCardClick(t.result)},this._cardNodeCheck=function(e){return e.getAttribute&&e.getAttribute("data-history-id")},this.container=r,this.onCardClick=i,this.emptyMessageShow=!1,this._createBox()}return r(e,[{key:"_createBox",value:function(){var e=document.createElement("div");e.className="srm-history",this.container.appendChild(e),this.box=e,this.box.addEventListener("click",this._handleBoxClick)}},{key:"_clearElement",value:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},{key:"_getCardBox",value:function(e){var t=document.createElement("div");return t.className="srm-history__item",t.setAttribute("data-history-id",e.id),t.innerHTML=(0,i.default)(e),t}},{key:"addHistoryCard",value:function(e){this._removeEmptyMessage(),this.box.insertBefore(this._getCardBox(e),this.box.firstChild)}},{key:"_removeEmptyMessage",value:function(){this.emptyMessageShow&&(this._clearElement(this.box),this.emptyMessageShow=!1)}},{key:"_renderEmptyMessage",value:function(){this.box.innerHTML=(0,a.default)(),this.emptyMessageShow=!0}},{key:"_renderCards",value:function(e){var t=this;this._removeEmptyMessage();var n=document.createDocumentFragment();e.forEach(function(e){n.appendChild(t._getCardBox(e))}),this.box.appendChild(n)}},{key:"render",value:function(e){this._clearElement(this.box),e&&e.length?this._renderCards(e):this._renderEmptyMessage()}}]),e}();t.default=c},,function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(6);var i=function(){function e(t){var n=t.container;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=n,this.marker=null,this._createBox()}return r(e,[{key:"_createBox",value:function(){var e=document.createElement("div");e.className="srm-map",this.container.appendChild(e),this.box=e}},{key:"_createMap",value:function(e){this.map=new window.google.maps.Map(this.box,{center:e,zoom:16})}},{key:"_createMarker",value:function(e){var t=e.name,n=e.location;this.marker=new window.google.maps.Marker({position:n,label:t,map:this.map})}},{key:"setCenter",value:function(e){this.map?this.map.setCenter(e):this._createMap(e)}},{key:"addMarker",value:function(e){var t=e.name,n=e.location;if(this.map||this._createMap(n),null===this.marker)return this._createMarker(e),void this.setCenter(n);this.marker.setMap(null),this.marker.setLabel(t),this.marker.setPosition(n),this.setCenter(n)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){var n=this,r=t.container,i=t.onPlaceChange;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._handlePlaceChange=function(){var e=n.autocomplete.getPlace(),t=e.geometry.location;n.clear(),n.onPlaceChange({name:e.name,location:{lat:t.lat(),lng:t.lng()}})},this.container=r,this.onPlaceChange=i,this._createBox()}return r(e,[{key:"_createBox",value:function(){var e=document.createElement("div");e.className="srm-search-box";var t=document.createElement("input");t.className="srm-search-box__input",this.input=t,e.appendChild(t),this.container.appendChild(e),this.autocomplete=new window.google.maps.places.Autocomplete(t),this.autocomplete.addListener("place_changed",this._handlePlaceChange)}},{key:"clear",value:function(){this.input.value=""}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){var n=t.container;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=n,this._createBox()}return r(e,[{key:"_createElement",value:function(e){var t=document.createElement("div");return t.className=e,t}},{key:"_createBox",value:function(){this.root=this._createElement("srm-layout"),this.searchBox=this._createElement("srm-layout__search-box"),this.history=this._createElement("srm-layout__history"),this.map=this._createElement("srm-layout__map"),this.root.appendChild(this.searchBox),this.root.appendChild(this.history),this.root.appendChild(this.map),this.container.appendChild(this.root)}},{key:"getSearchBoxContainer",value:function(){return this.searchBox}},{key:"getHistoryContainer",value:function(){return this.history}},{key:"getMapContainer",value:function(){return this.map}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new Map;t.publish=function(e,t){r.has(e)&&r.get(e).forEach(function(e){return function(e,t){try{t(e)}catch(e){console.log(e)}}(t,e)})},t.subscribe=function(e,t){r.has(e)||r.set(e,new Set),r.get(e).add(t)},t.unsubscribe=function(e,t){if(r.has(e)){var n=r.get(e);n.delete(t),0===n.size&&r.delete(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(10));var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.place,r=void 0===n?{}:n,a=t.history,o=void 0===a?[]:a,u=t.eventEmitter,c=void 0===u?i:u;this.place=r,this.history=o,this.eventEmitter=c}return r(e,[{key:"_collectPlaceObj",value:function(e){if(e.id)return e;var t=e.location,n=t.lat+"-"+t.lng;return Object.assign({},e,{id:n})}},{key:"setPlace",value:function(e){var t=this._collectPlaceObj(e);this.place.id!==t.id&&(this.place=t,this.publish("onPlaceChange",this.place))}},{key:"addHistoryItem",value:function(e){var t=this._collectPlaceObj(e);this.history.unshift(t),this.publish("onAddHistoryItem",t)}},{key:"getHistory",value:function(){return this.history}},{key:"getPlace",value:function(){return this.place}},{key:"selectHistoryItem",value:function(e){if(this.history.length){var t=this.history.find(function(t){return t.id===e});t&&this.setPlace(t)}}},{key:"subscribe",value:function(e,t){this.eventEmitter.subscribe(this._getEventName(e),t)}},{key:"unSubscribe",value:function(e,t){this.eventEmitter.unsubscribe(this._getEventName(e),t)}},{key:"publish",value:function(e,t){this.eventEmitter.publish(this._getEventName(e),t)}},{key:"_getEventName",value:function(e){return e?"SRM-Model-"+e:"SRM-Model"}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(11)),i=s(n(9)),a=s(n(8)),o=s(n(7)),u=s(n(4)),c=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.container,n=new r.default,s=new i.default({container:t});new a.default({container:s.getSearchBoxContainer(),onPlaceChange:function(e){n.setPlace(e),n.addHistoryItem(e)}});var l=new o.default({container:s.getMapContainer()});!function(e,t){var n=t.getPlace();n.location?e.addMarker(n):(0,c.default)(function(n){t.getPlace().location||e.setCenter(n)})}(l,n);var f=new u.default({container:s.getHistoryContainer(),onCardClick:function(e){return n.selectHistoryItem(e)}}),d=n.getHistory();f.render(d),n.subscribe("onPlaceChange",function(e){return l.addMarker(e)}),n.subscribe("onAddHistoryItem",function(e){return f.addHistoryCard(e)})}},function(e,t,n){e.exports=n.p+"favicon.png"},,function(e,t,n){},function(e,t,n){"use strict";n(15),n(13);var r,i=n(12),a=(r=i)&&r.__esModule?r:{default:r};window.srm=function(){return(0,a.default)({container:document.getElementById("srm-app")})}}]);